<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GMC主页面</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../js/jquery-3.4.1.js"></script>
    <script src="../layui/layui.js"></script>
    <script>
        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test1',
                width: '100%',
                arrow: 'hover'
            });
        });
    </script>
    <script>
        layui.use('element', function () {
            var element = layui.element;
        });
    </script>
    <script type="text/javascript">

    </script>
    <script>
        // $(function () {
        //     $("#Navigation").onclick=function getArray() {
        //         var noLogin = {};
        //         var Bvo={};
        //         var Mvo={};
        //         var admin={};
        //
        //         $.ajax({
        //             type: 'POST',
        //             dataType: "json",
        //             contentType: "application/json",
        //             url: "http://localhost:8080/menu/initMenu",
        // 			data:{},
        //             success:function(data) {
        //                 var result=data.data;
        //                 alert("已执行");
        //                 //按照当前值来过滤菜单，
        //                 $.each(result,function (index,menuItem) {
        //                     if (menuItem.menuPrivilege=="1"){
        //                         admin.push(menuItem);
        //                     } else if (menuItem.menuPrivilege=="2") {
        //                         Bvo.push(menuItem);
        //                     }else if (menuItem.menuPrivilege=="3"){
        //                         Mvo.push(menuItem);
        //                     } else{
        //                         noLogin.push(menuItem);
        //                     }
        //                 })
        //                 console.log(noLogin);
        //                 console.log(Mvo);
        //                 console.log(Bvo);
        //                 console.log(admin);
        //                 console.log(result);
        //                 //重新组装页面
        //             },
        //             error : function(e){
        //                 alert("已执行");
        //                 console.log(e.status);
        //                 console.log(e.responseText);
        //             }
        //         });
        //     };
        // })
        /**
         * 初始化菜单
         */
        $(function () {
            $.ajax({
                type: 'POST',
                dataType: "json",
                contentType: "application/json",
                url: "http://localhost:8080/menu/initMenu",
                data: {},
                success: function (data) {

                    //菜单分类
                    var noLogin = new Array();
                    var Bvo = new Array();;
                    var Mvo = new Array();;
                    var admin = new Array();;
                    for (i in data){
                        if (data[i].menuPrivilege=="1"){
                            admin.push(data[i]);
                        } else if (data[i].menuPrivilege == "2") {
                            Bvo.push(data[i]);
                        } else if (data[i].menuPrivilege == "3") {
                            Mvo.push(data[i]);
                        } else {
                            noLogin.push(data[i]);
                        }
                    }

                    //按照当前登录状态获取初始化菜单
                    var stateId=document.getElementById("stateId").innerText;
                    //console.log(stateId);
                    if(stateId=='未登陆'){
                        setMenu(noLogin);
                    }else if(stateId=='品牌商'){
                        setMenu(Mvo);
                    }else if(stateId=='借卖商'){
                        setMenu(Bvo);
                    }else{
                        setMenu(admin);
                    }
                },
                error: function (e) {
                    alert("菜单刷新出错，请重新登陆");
                }
            });
        });

        // 能够根据传递的数组组装页面
        function setMenu(a) {
            var htmlElem = document.getElementById('leftmenubar');
            for (var i in a) {
                var $addHtml = $("<li class='layui-nav-item'><span>" + a[i].menuPrivilege + "</span></li>");
                $("#leftmenubar").append($addHtml);
            }
        }

        function changeMainFrame(url) {
            $("#otherBar").src = url;
        }


    </script>

    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        html,
        body {
            width: 100%;
            height: 100%;
        }

        #Navigation {
            width: 100%;
            height: 20%;
            left: 0px;
            top: 0px;
        }

        #operation {
            width: 100%;
            height: 80%;
            top: 20%;
            left: 0px;
        }

        #menu {
            float: left;
            width: 15%;
            height: 100%;
            left: 0%;
            top: 0%;
        }

        #frame {
            float: left;
            width: 85%;
            height: 100%;
            top: 0%;
            left: 15%;
        }

        #otherBar {
            width: 100%;
            height: 100%;
        }

        #leftmenubar {
            width: 100%;
            height: 100%;
        }

        #topmenubar {
            width: 100%;
            height: 50%;
        }

        #systemTitle {
            width: 100%;
            height: 50%;
        }
    </style>
</head>
<body>
<!--导航栏-->
<div id="Navigation">
    <img src="../img/GMC.png" id="systemTitle">
    <ul class="layui-nav" id="topmenubar">
        <li class="layui-nav-item"><a href="https://jupage.taobao.com/wow/tttj/act/index">最新活动</a></li>
        <li class="layui-nav-item layui-this">爆款产品</li>
        <li class="layui-nav-item"><a href=""></a></li>
        <li class="layui-nav-item">
            <a href="http://www.sdongpo.com/groupbuy">其他团购</a>
            <dl class="layui-nav-child">
                <!-- 二级菜单 -->
                <dd><a href="https://github.com/tianxiaode/qTemplate-ExtJS">移动模块</a></dd>
                <dd><a href="https://github.com/ColorlibHQ/AdminLTE">后台模版</a></dd>
                <dd><a href="https://www.suning.com/">苏宁</a></dd>
            </dl>
        </li>
        <li class="layui-nav-item"><a href="https://index.bbs.taobao.com/home.html">社区</a></li>

        <li class="layui-nav-item">
            <a href="">控制台<span class="layui-badge">9</span></a>
        </li>
        <li class="layui-nav-item">
            <a href="../login.html">未登录<span class="layui-badge-dot"></span></a>
        </li>
        <li class="layui-nav-item">
            <a><img src="//t.cn/RCzsdCq" class="layui-nav-img">
                <span id="stateId">品牌商</span>
            </a>
            <dl class="layui-nav-child">
                <dd><a href="../login.html">登陆</a></dd>
                <dd><a href="../register.html">注册</a></dd>
                <dd><a href="https://baike.baidu.com/item/借卖">关于GMC</a></dd>
            </dl>
        </li>
    </ul>
</div>


<div id="operation">
    <!--菜单栏-->
    <div id="menu">
        <ul class="layui-nav layui-nav-tree" lay-filter="test" id="leftmenubar">
            <li class="layui-nav-item " id="menuItem">
                <span>菜单列表</span>
            </li>
        </ul>
    </div>

    <!--轮播-->
    <div id="frame">
        <iframe src="hotProduct.html" id="otherBar"></iframe>
    </div>
</div>
</body>
</html>
