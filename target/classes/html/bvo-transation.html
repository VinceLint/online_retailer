<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>交易流水</title>


    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

</head>
<style>
    .btn-3{
        margin-top:10px;
        padding-top:20px;
        position:absolute;
    }
</style>
<body>
<div class="page-header position-relative">
    <h1 style="color: #2679b5;">借卖方 <small><i class="el-icon-d-arrow-right"></i> 交易流水</small></h1>
    <hr><br>

</div>

<!-- import CSS -->
<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>

<div id="app">

<!--    <el-input-->
<!--            v-model="search"-->
<!--            size="mini"-->
<!--            placeholder="输入关键字搜索"/>-->
    <div id="table">
        <el-table
                :data="tableData"
                border
                style="width: 100% ;text-align: center"
                stripe="true">
            <el-table-column
                    label="交易流水号"
                    prop="tid">
            </el-table-column>

            <el-table-column
                label="交易金额"
                prop="tnum">
        </el-table-column>

            <el-table-column
                    label="交易类型"
                    prop="ttype">
            </el-table-column>

            <el-table-column
                    label="余额"
                    prop="tbal">
            </el-table-column>

            <el-table-column
                    label="时间"
                    prop="ttime">
            </el-table-column>



            <el-table-column

                    align="right"
                label="状态"
                prop="tstatus">

            </el-table-column>
        </el-table>

        </template>

        <br>

    </div>
    <div class="block">
        <nav style="text-align: center">
        <span class="demonstration"></span>
        <el-pagination
                background
                @current-change="handleCurrentChange"
                :current-page="currentPage4"
                :page-size="7"
                layout="total, prev, pager, next, jumper"
                :total="pageTotal">
        </el-pagination>
        </nav>
    </div>
</div>



<script>



    var vm1=new Vue({
        el: '#app',
        data: function () {
            return {
                form:{
                    id:'',
                    bal:'',
                    sign:1
                },
                search: '',
                tableData :[],
                ztype:["提现","充值","消费","收入"],
                zstatus:["待审核","审核通过","审核未通过"],

                currentPage4: 1,
                pageTotal:0,
            }
        },
        methods: {
            init() {
                var that=this;
                this.tableData=[]

                $.ajax({
                    type: "post",
                    url: "http://127.0.0.1:8080/online_retailer_war_exploded/toTransationList",
                    dataType: "json",
                    success: function (r) {
                        $.each(r,function(i,obj){
                            this.tableData.push({
                                tid:obj.traRecId,
                                tnum:obj.traRecSum,
                                ttype:this.ztype[obj.traRecType],
                                tstatus:this.zstatus[obj.traRecStatus],
                                tbal:obj.traRecBalance,
                                ttime:obj.traRecDateStr,
                            })
                        }.bind(this))

                        console.log(r);

                    }.bind(this)
                });
            },

            handleCurrentChange(val) {
                console.log(`当前页: ${val}`);
                this.tableData=[]
                $.ajax({
                    type:"get",
                    url:"http://127.0.0.1:8080/online_retailer_war_exploded/changeTransationList/"+val,
                    dataType:"json",
                    success:function(data){

                            $.each(data, function (i, obj) {
                                if(i!=data.length-1) {
                                    this.tableData.push({
                                        tid: obj.traRecId,
                                        tnum: obj.traRecSum,
                                        ttype: this.ztype[obj.traRecType],
                                        tstatus: this.zstatus[obj.traRecStatus],
                                        tbal: obj.traRecBalance,
                                        ttime: obj.traRecDateStr,
                                    })
                                }
                            }.bind(this))

                        this.pageTotal=data[data.length-1],
                        console.log(data);

                    }.bind(this)

                })
            }
        },
        mounted:function(){
            this. handleCurrentChange(1);
        }


    })


</script>


</body>
</html>
